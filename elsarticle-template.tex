\documentclass[review]{elsarticle}

\usepackage{lineno,hyperref}
\usepackage[dvipdfmx]{graphicx}
\usepackage{url}
\modulolinenumbers[5]

%%\journal{Journal of \LaTeX\ Templates}

%%%%%%%%%%%%%%%%%%%%%%%
%% Elsevier bibliography styles
%%%%%%%%%%%%%%%%%%%%%%%
%% To change the style, put a % in front of the second line of the current style and
%% remove the % from the second line of the style you would like to use.
%%%%%%%%%%%%%%%%%%%%%%%

%% Numbered
%\bibliographystyle{model1-num-names}

%% Numbered without titles
%\bibliographystyle{model1a-num-names}

%% Harvard
%\bibliographystyle{model2-names.bst}\biboptions{authoryear}

%% Vancouver numbered
%\usepackage{numcompress}\bibliographystyle{model3-num-names}

%% Vancouver name/year
%\usepackage{numcompress}\bibliographystyle{model4-names}\biboptions{authoryear}

%% APA style
%\bibliographystyle{model5-names}\biboptions{authoryear}

%% AMA style
%\usepackage{numcompress}\bibliographystyle{model6-num-names}

%% `Elsevier LaTeX' style
\bibliographystyle{elsarticle-num}
%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\begin{frontmatter}

\title{Visualization System to Analyze Conversation in Psychological Counseling}
%\tnotetext[mytitlenote]{Fully documented templates are available in the elsarticle package on \href{http://www.ctan.org/tex-archive/macros/latex/contrib/elsarticle}{CTAN}.}

%% Group authors per affiliation:
%\author{Tomoya Uetsuji \fnref{myfootnote}\corref{mycorrespondingauthor}}
%\cortext[mycorrespondingauthor]{Corresponding author}
%\ead{uetsuji@viz.media.kyoto-u.ac.jp}
%\address{Kyoto University, Kyoto, Japan}
%\fntext[myfootnote]{Since 1880.}

%% or include affiliations in footnotes:
\author[mysecondaryaddress]{Tomoya Uetsuji \corref{mycorrespondingauthor}}
\cortext[mycorrespondingauthor]{Corresponding author}
\ead{uetsuji@viz.media.kyoto-u.ac.jp}

\author[mymainaddress]{Minoru Kamata}
%\ead[url]{www.elsevier.com}

\author[mysecondaryaddress]{Yasuo Ebara}
\author[mysecondaryaddress]{Koji Koyamada}



\address[mysecondaryaddress]{Kyoto University, Kyoto, Japan}
\address[mymainaddress]{Kurokawa Clinic, Osaka, Japan}


\begin{abstract}
Illness in health conditions involving changes in thinking, emotion or behavior is one of the most pressing public health issues of our time. While counseling and psychotherapy can be effective treatments, current supervision for beginner counsellors about how to conduct successful counseling conversations has been limited due to lack of an appropriate visual analytic system for the counseling transcripts. In this paper, we present a visual analytic system to help expert counsellors understand the conversation flow caused by the beginner counsellors. We develop a set of novel visualization methods to measure how various linguistic aspects of conversations are correlated with conversation outcomes. Applying the proposed visual analytic system to the counseling transcripts, we discover that our system can facilitate counsellors make effective supervision strategies that are associated with better conversation outcomes. Also, we discovered that counselors can check the condition of cognitive correction by our proposed time-series visualization of human relationship chart with behavior arrows.
\end{abstract}

\begin{keyword}
\texttt{VISUALIZATION}\sep FLOW OF CONVERSATION \sep COUNSELING
\end{keyword}

\end{frontmatter}

\linenumbers

%%



 \begin{figure}
   \begin{center}
     \includegraphics[width=\linewidth]{fig1.png}
   \end{center}
   \caption{An example of the time-series visualization of our proposed character relationship chart with behavior arrow from the dependency analysis of the text data. The arrows show behavior. Circle shows behavior that means (1) or (3) of chart Gray arrow means (4) or (5). Red arrow means (2). Slider selects the visualized area of the input text. If we click a circle or a arrow, the original texts including verbs which the circle or the arrow appear at the left side of the screen}
   \label{fig1}
 \end{figure}

\section{Introduction}

  
 In psychological counseling, treatment is offered to a psychosomatic patient or client mainly due to the physical symptoms caused by stress. However, beginner counselors often have difficulty turning their attention to the cognitive characteristics of the internal problems faced by clients. Beginner counselors tend to direct the psychological counseling process to suit their interests and frequently use close-ended questions (to which a client can answer "Yes" or "No") to obtain a client's confirmation of the interpretation they have offered.

 In contrast, expert counselors provide an opportunity for education and training by offering advice to beginner counselors on the content of their counseling conversations. Expert counselors need to educate beginner counselors about how to use open-ended questions (questions characterized by 5W1H) freely. However, due to privacy and client confidentiality issues, experts can rarely obtain voice data from beginner counselors' psychological counseling sessions. Therefore, it is usual for expert counselors to only read direct phonetic transcriptions of conversation of counseling sessions in supervision to support the education of beginner counselors.

However, transcript documents that comprise the text data of conversations in psychological counseling are large in scale and complex. It is very difficult for the supervisor to extract the conversational characteristics from the situation that exists between a beginner counselor and a client by referring to such data. To improve the accessibility of counseling conversations, we propose that visualization of data is more effective. Accordingly, we have developed an appropriate method to visualize the client's answers to each of the beginner counselor's questions.

 This study proposed and developed a system for visualizing the flow of the psychological counseling conversation. One of our proposed systems visualizes the distribution of relationship changes between begineer counselor's questions and client's answers over time, with a bar chart depicting the results by category classification based upon Adlerian psychology. In this study, we present an overview of the system and the results of the user evaluation by expert counselors. The intended users of our visualization of conversation flow is the expert counselors.

 In addition, as the percentage of a client's utterance about their own actions toward others begins to outweigh their utterance about others' actions toward themselves, the client's cognitive correction is understood to be progressing, as in Fig. 2. In other words, "If you are interested in changing your own behavior rather than changing the behavior of the opponent, cognitive correction is progressing"  \cite{zokad}. Therefore, we propose that classifying the client's behavior according to the information provided by the counseling conversation data, and then visualizing the result, reveals the degree of modification of the client's perception and cognition in psychological counseling. we visualized the conversation data using a method that combines a human relationship chart with the behavior enacted by the people discussed in the psychological counseling conversation. We considered that counselors can check the condition of cognitive correction by our proposed time-series visualization of human relationship chart with behavior arrows.
   
    \begin{figure}
   \begin{center}
     \includegraphics[width=\linewidth]{fig2.png}
   \end{center}
   \caption{Categories of behavior based upon a counseling client analysis. The coloring depicted above was used for our proposed system as in Figure 1.}
   \label{fig2}
 \end{figure}

\section{Related work}
 There are several relevant studies referring to visualizations of conversations. In this section, we review the related work and locate the position of our study.

Heliang visualized the topic of the client with a line chart and three-dimensional spiral structure in a web-based psychological counseling system \cite{shou}. However, from the viewpoint of our visualization of the flow of a one-on-one conversation between a beginner counselor and client, it is important to visualize both by combining the content of each utterance.

 Eric et al. visualized conversational data using an asymmetry layer line chart, with the top and bottom depicting the time distribution of topics, which were divided by two kinds of technique \cite{taskdriven}. Our researchers agreed that the visualization technique of painting pictures with an asymmetry line chart on the top and bottom is a useful method to depict each utterance by the client and the beginner counselor. However, to visualize the flow of conversation in psychological counseling, it is important to listen to how the client responds to the questions by the beginner counselor.

  Ito developed the system that enables to visualize the time series transition for blog user?s interesting topics in three dimensions \cite{itoh2010interactive}. In our study, the information of utterance by a client consists of three-dimensional data by time series, group of sentences, and number of sentences. On the other hands, the information of utterance by a beginner counselor is two-dimensional data by time series and question type. However, we decided that the conversation flow between a client and a beginner counselor can best be visualized using a two-dimensional chart with color coding.
  
   El-Assady\cite{el2016contovi} developed a visual analytics approach to analyze speaker patterns with character circle, talk category circle chart and circles which size means the talk quantity about the category from the speaker.  The character circle expresses the conversation by circling where you are in the topic. However, their visualization cannot be used unless the topic classifications of counselor and client are the same, so we cannot determine the relationship between questions and answers from their visualization.

  A. Tat \cite{tat2002visualising} used audio visualization, which demonstrated how behavior is augmented by the addition of behavioral history.
? Tony Bergstrom [7] aimed to determine the speaker's emotion by how he/she is connected to another speaker during a conversation. However, these methods do not visualize conversation content categories using a natural language procedure, so we cannot determine the relationship between questions and answers from this visualization.

  van Ham \cite{van2009mapping} et al. conducted a study that analyzed sentences at high speed, where their relationships such as "A of B" and "A and B" were specified by the user and expressed in a direct graph. However, using their system, we cannot determine why these words are connected, and when the connections caused appeared in the input text data.

  Tanaka et al. \cite{tanaka} developed?the interface that efficiently recalls the contents of the story. However, they visualize frequent keywords including ones which are not characters. Also, they have not done partial visualization of what kind of directional human relationship it was in what scene. 

\section{Basic explanation of counseling}

 In this section, we explain the basics of counseling necessary for the development of our proposed system. Adlerian psychology is the theory we used to analyze the data in our proposed system. 

Adlerian psychology is regarded as the forerunner to cognitive behavioral therapy (CBT). The therapist works on cognitive adjustment with the client in CBT, and here, a similar approach is taken. Adlerian psychology is a system of psychological theory, thought, and treatment technique developed by the Austrian psychiatrist Alfred Adler and his successors\cite{grad2002preamble}.  Adler said "All the problems of life can be categorized into three major tasks, that is, a task of companion, a task of work, a task of love and family \cite{ad2} Adlerian psychology in the life task, from the relationship of the affinity for the inquirer, the work task: the non-permanent human relationship., the task of the friendship: the persistence, but the human relationship not doing fate, the task of love and family: permanent, destiny as Table 1. It helps to get problems on human relations. For three categories in the story on human relationships, it can be judged that those who do not move so much in counseling can derive the cause of bad emotion from the patient more deeply. In clinical terms, it is said to be extremely effective to classify human problems into these three areas to help identify further work from the clinical point of view.

       \begin{table}
   \caption{Three life task based on Adler psychology.}
   \label{table:table1}
   \begin{center}
     \includegraphics[width=\linewidth]{table1.png}
   \end{center}
 \end{table}

The pre-procedure of our proposed conversation flow visualization is based on the above classification method. In this research, visualization along the time axis depicts the flow of the conversation between the client and the counselor and clarifies how the flow of the conversation changes according to the questions asked by the counselor.

On the other hand, the analysis of the client's cognitive correction attends to the changes in the categories of the client's behavior, as mentioned as Fig. 2, including the behavior of the people around the client. According to M. Kamata \cite{kamata2002}, the counselors' role is to encourage the client so that the client can develop self-determination and self-responsibility. This enables the client to form a cooperative relationship with others, without unreasonably intervening in others' behavior or emotions. It is important for the counselor to discover how the client's own behavior or emotions can develop without unjustly intervening in the behavior or emotions of others. The pre-procedure of our proposed character relationship chart visualization is based on the above classification method. 

\section{Pre-procedure of proposed visualization systems}

  In this chapter, we explain in detail the requirements for developing visualization system based on comments from expert counselors and the design and implementation of the proposed system. 

\subsection{Fundamentals of counseling}

\subsubsection{Counselor education}
  
  From the clinical point of view, it is considered extremely effective to classify human problems into three categories. From the classification method, we explain the extrbehavior of requirement for the proposed conversation flow visualization, design and implementation in the next sub-section.

\subsubsection{client analysis}

 In counseling, it is said that "those who are interested in changing their own behavior rather than changing the behavior of the other party are progressing in modifying cognition." It is said that the modification of the client's perception is progressing when the client focuses on the clients' own behavior, rather than on other people's behavior.
 
 We decided that we can represent the condition of the client's perception by visualizing the data as "person's behavior around the client" or "client's own behavior." In addition, we thought that we could satisfy the above requirements by visualizing the subjects and predicates of behavior in conversational content text, in chronological order. In response to these requirements, we developed a time-series visualization tool using human relationship charts that include the subject and object of behavior.

\subsection{System design}

\subsubsection{Visualization of the flow of conversation with classification of questions and answers}

This section describes the design and implementation of our proposed system. Fig.3 shows the processing procedure of our visualization system depicting the flow of conversation in counseling. In this system, the classification of conversation text data in counseling during the pre-processing stage of visualization is executed.

      \begin{figure}
   \begin{center}
     \includegraphics[width=\linewidth]{fig3.png}
   \end{center}
   \caption{Processing procedure system for visualizing the flow of conversation in counseling.}
   \label{fig3}
 \end{figure}

  In this system, one comment from the person in charge or the counselor is judged by the change of the speaker. In other words, one comment from one of the talkers is until the counselor finishes talking and the talker starts talking, until the clinic speaks and the therapy begins to talk. Also, one utterance by the counselor is from the time the talker finishes talking, or the counselor starts tearing out the talk, until the counselor finishes talking and the informer starts talking.

 In this system, the utterances of the client correspond to one task area from "work," "friendship," or "love and family," based on Adlerian psychology. However, the utterances of the beginner counselor are classified into five categories as shown in Table 2.
Fig. 4 shows the flow of automatic classification methods for the counselor's questions as in Table.2. First, statements with interrogatives indicating "5W1H," such as "when," "where," "what," and so on, are categorized as "open questions." Next, among the remaining utterances, those with 5 or fewer words are classified as "feedback." After that, those remaining utterances that include the Japanese final enclosing particle "ka" are classified as "close-ended questions." Those utterances that remain unclassified are termed "interpretation" if they contain the Japanese final ending particle "ne," and the rest is "idol talk."
  
       \begin{table}
   \caption{Category pattern of beginner counselor's utterances.}
   \label{table:table2}
   \begin{center}
     \includegraphics[width=\linewidth]{table2.png}
   \end{center}
 \end{table}
  
        \begin{figure}
   \begin{center}
     \includegraphics[width=\linewidth]{fig4.png}
   \end{center}
   \caption{The flow of automatic classification method for counselor's questions as in Table 2.}
   \label{fig4}
 \end{figure}

First, our proposed system read the conversation data of each text on the browser and performed a morphological analysis to separate the text into words. The morphological analysis subsystem, kuromoji.js \cite{kuromojijs} was used, which is a morphological analysis library of JavaScript language. Kuromoji.js is an open source Japanese morphological analysis engine implemented in Java Kuromoji\cite{kuromoji} and ported to JavaScript.

  Then, these sentences are classified into each category by matching with the keyword corresponding to the classified word dictionary registered in this system and each word in the sentence. However, when this category classification method was applied to the text data of each utterance of the counselor and the client, the accuracy of the classification results depended on the word dictionary registered in the system, and the accuracy rate for classification was very low. Therefore, an expert counselor had to confirm the initial classification result from the current system and had to correct inaccurate classification results manually. The workload was large. In addition, an expert counselor suggested that the classification of the therapist's utterances should not be termed a sentence unit but a talker-turn unit.

Following the classification of utterance data, the type of question asked by the beginner counselor was categorized, and the distribution of changes over a time-series visualized. The category of each client utterance related to "work," "friendship," and "love and family" were visualized at the same time.

\subsubsection{Visualization of the time-series flow of behavior arrows in character relationship chart}

 In this section, we describe how to generate the human relations chart using a time-series and explain our method for extracting behavior data, time data, and subject and object data from the text data. Figure 5 depicts the flow of the pre-procedure.
  
          \begin{figure}
   \begin{center}
     \includegraphics[width=\linewidth]{fig5.png}
   \end{center}
   \caption{The flow of pre-procedure for visualizing character relationship chart}
   \label{fig5}
 \end{figure}


%%

    This subsection explains how to extract characters from sentences. The system input is the output result of the KNP\cite{kawahara2006fully} dependency analyzer, which was generated when the counseling conversation transcript text data was input into KNP. Next, words (character candidates) classified as "category: person" were extracted. Then, the original sentence was morphologically analyzed by the Japanese language morphological analyzer JUMAN\cite{juman}. JUMAN categorizes each word of Japanese with its own dictionary during morphological analysis. Therefore, by extracting words classified as the "people" category by JUMAN, we extracted the characters of sentences.

 In addition, we obtained a verb list. Next, we analyzed the expression of dependency around each verb so that we could identify the subject or object of each verb.  Then, according to the number of verbs that has the same pair of the subject and the object the counseling conversation text has, we expanded the stroke width of circles or arrows in Figure 1 chart by the number of verbs the circles or arrows mean.
  
  %%
  






\section{Visualization results}

\subsection{Visualization of the flow of conversation with classification of questions and answers}

  In this chapter, we describe the visualization results of our proposed system. Figure 6 show examples of the visualization result of the flow of conversation in this proposed system. The visualization result consists of three items.  We used D3.js\cite{vand3} for the visualization. it based on written transcripts.
  
            \begin{figure}
   \begin{center}
     \includegraphics[width=\linewidth]{fig6.png}
   \end{center}
   \caption{This is a bar chart visualization of the flow of conversation in this proposed system. In the chart area, the upper half represents the counselor's questions and lower half  represents the client's answers. The coloring follows the key in  Table 2 and 3. If you hover a mouse cursor over any block in each bar chart, the original text which the block represents appears in the lower right side of the screen.}
   \label{fig6}
 \end{figure}



Figure 6 presents a bar chart visualization of the flow of conversation in this proposed system. In the chart area, the upper half represents the counselor's questions and lower side represents the client's answers. One bar chart is represented as one utterance. Table 3 shows the allocation of color for each bar chart representing the utterance of a beginner counselor or a client in counseling. We decided that the number of beginner counselor utterances and the order of utterances by the client can most clearly be expressed in a bar chart format.

     \begin{table}
   \caption{Coloring for category pattern of beginner counselor's utterances.}
   \label{table:table3}
   \begin{center}
     \includegraphics[width=\linewidth]{table3.png}
   \end{center}
 \end{table}

\part{Utterance classification manual correction function}

 In the bottom left of Figure 6, an expert counselor can correct the classification results manually. In the bottom right of Figure 6, all the text data content in the counseling conversation is displayed. We implemented a mouse over function in the bar chart that displays the classification of questions to the client by the beginner counselor. For ease of viewing, each statement was displayed with black letters, instead of the color corresponding to the color of the chart and was surrounded by a corner bracket??of color corresponding to the area of the chart.
 
 The client's problems were categorized according to one of three groups; "work," "friendship," and "love and family," which were further defined using Adlerian psychology. However, additional classification categories such as "self" and "spiritual" have been suggested by an expert counselor. We decided that problems such as "self" or "spiritual" were difficult to fully understand or define and will need to be addressed in future research.


\subsection{Visualization of the time-series flow of behavior arrow in character relationship chart}

  Figure 1 shows the image of the time-series human relationship chart. By moving the lower slider, we can display the human relationship chart from sentence to sentence along the time-series. Moreover, as shown in Figure 2, by making it possible to display the sentence of the corresponding verb, we can know which original text the arrow means. We used D3.js\cite{vand3} for the visualization.

.
\subsection{User Evaluation}
\subsubsection{Visualization of the flow of conversation with classification of questions and answers}

We evaluated the function of this system with expert counselors as the system users and discussed their review comments during the evaluation. The purpose of the evaluation was to discover answers to the following questions:
  \begin{itemize}
\item Does a system seem to be usable for counselor education/educating?
\item Does each chart and original text viewing function seem to be usable for counselor education?
\end{itemize}

We performed a system evaluation with three expert counselors, using a visualization system as a rating scale. Their average age was 55 years old. Their average amount of clinical experience was 29 years.
First, the evaluators confirmed the flow of the counseling conversation by moving the mouse cursor to the time-series visualization result.

 We also asked some open-ended written questions in this evaluation. According to the answers to the question "What kind of guidance can be given to the counselor when viewing the bar chart?", we decided that various recommendations can be made to a new counselor by reviewing changes in the distribution of utterance, when the conversation in analyzed as a whole.

 In addition, we received user comments saying:

  \begin{itemize}
\item In order to understand that it is a prerequisite that it is assumed that a consultative relationship is established between the counselor and the client
\item Based on this result, it can be used as a material for rebuilding counseling
\end{itemize}
In view of the above, we got a comment that, when the expert counselor educates a beginner counselor, the system could show him the relationships between the beginner counselor's questions and the client's answers which he could not grasp by just reading a conversation transcript. From the above results, as a whole, we think that it is concluded by answers from multiple experienced counselors that the flow of conversation is properly visualized so that this system educate the beginner counselors with the relationships between the beginner counselor's questions and the client's answers which he could not grasp by just reading a conversation transcript.

\subsubsection{Visualization of the time-series flow of behavior arrow in character relationship chart}

The expert counselor said that he discovered that the idea "I want B to follow my will" disappeared and self-referenced tasks increased as cognitive correction progressed. This progress could be confirmed by changing the quantity of arrows and confirms the quality in the original text display. We decided that our proposed character chart visualization helps counselors to discover when the client's cognitive correction is progressing and, furthermore, how those corrections are made.

 In view of the above, we got a comment that, the system could show the counselors which the client's behaviors and the surrounded people's behaviors the client's mentioned, which the counselor's could not grasp by just reading a conversation transcript. We consider that our proposed character relationship chart visualization helps counselors find out that some kind of client's cognitive fixes were made with the new information about which the client's behaviors and the surrounded people's behaviors the client's mentioned, which the counselor's could not grasp by just reading a conversation transcript.

\section{Conclusion and future work}

 This paper concludes that various recommendations can be made to a new counselor by reviewing changes in the distribution of utterance, when the counseling conversation is analyzed as a whole. The feedback provided by several experienced counselors demonstrates that the flow of conversation is properly visualized and that this system can help to educate and train a new counselor. Furthermore, this flow visualization system could be applied to conversations other than counseling, such as job interviews.

 In addition, by visualizing the subject and object of the action in the text with arrows, it becomes possible to visualize the data by referring to the behavior of people around the client or the client's own behavior. We conclude that counselors can assess the progression of the client's cognitive correction by using our proposed time-series human relationship chart, with additional behavior arrows. Our time-series visualization of the direction of behavior using human relationship charts could be applied to fields other than counseling. For example, our visualization tool could track the development of characters in texts, such as a novel or film script.

 Our proposed system can be applied in languages other than Japanese, such as English, by changing the language used for processing.

%    \begin{table}
%   \caption{治療者と来談者の発言の全ての文の数，単語数，文字数とその比}
%   \label{table:book2}
%   \begin{center}
%     \includegraphics[width=\linewidth]{book2.png}
%   \end{center}
% \end{table}
% 
% \begin{figure}
%   \begin{center}
%     \includegraphics[width=\linewidth]{0801.png}
%   \end{center}
%   \caption{会話データ1でのグラフ描画結果}
%   \label{fig:0801}
% \end{figure}




%%

\section*{References}

\bibliography{mybibfile}

\end{document}